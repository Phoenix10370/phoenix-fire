{% extends "base.html" %}
{% block content %}

<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h1 class="h3 mb-1">
      {% if mode|default:"create" == "create" %}New Job Task{% else %}Edit Job Task{% endif %}
    </h1>
    <div class="text-muted">Create and manage tasks linked to a Property and Customer.</div>
  </div>
  <div>
    <a href="{% url 'job_tasks:list' %}" class="btn btn-outline-secondary">Back to list</a>
  </div>
</div>

{% if form.errors %}
  <div class="alert alert-danger">
    Please fix the errors below.
  </div>
{% endif %}

<form method="post" class="row g-3">
  {% csrf_token %}

  <div class="col-lg-8">
    <div class="card mb-3 shadow-sm">
      <div class="card-header bg-light fw-semibold">Task</div>
      <div class="card-body">
        {{ form.non_field_errors }}

        <div class="mb-3">
          <div class="text-muted small mb-1">Title</div>
          {{ form.title }}
          {% if form.title.errors %}<div class="text-danger small mt-1">{{ form.title.errors }}</div>{% endif %}
        </div>

        <div class="mb-3">
          <div class="text-muted small mb-1">Description</div>
          {{ form.description }}
          {% if form.description.errors %}<div class="text-danger small mt-1">{{ form.description.errors }}</div>{% endif %}
        </div>

        <div class="row g-3">
          <div class="col-md-6">
            <div class="text-muted small mb-1">Status</div>
            {{ form.status }}
            {% if form.status.errors %}<div class="text-danger small mt-1">{{ form.status.errors }}</div>{% endif %}
          </div>
          <div class="col-md-6">
            <div class="text-muted small mb-1">Due Date</div>
            {{ form.due_date }}
            {% if form.due_date.errors %}<div class="text-danger small mt-1">{{ form.due_date.errors }}</div>{% endif %}
          </div>
        </div>

        <hr>

        <div class="row g-3">
          <div class="col-md-6">
            <div class="text-muted small mb-1">Service Date</div>
            {{ form.service_date }}
            {% if form.service_date.errors %}<div class="text-danger small mt-1">{{ form.service_date.errors }}</div>{% endif %}
          </div>

          <div class="col-md-6">
            <div class="text-muted small mb-1">Service Type</div>
            {{ form.service_type }}
            {% if form.service_type.errors %}<div class="text-danger small mt-1">{{ form.service_type.errors }}</div>{% endif %}
          </div>

          <div class="col-md-6">
            <div class="text-muted small mb-1">Service Technician</div>
            {{ form.service_technician }}
            {% if form.service_technician.errors %}<div class="text-danger small mt-1">{{ form.service_technician.errors }}</div>{% endif %}
          </div>

          <div class="col-md-6">
            <div class="text-muted small mb-1">Additional Technicians</div>
            {{ form.additional_technicians }}
            {% if form.additional_technicians.errors %}<div class="text-danger small mt-1">{{ form.additional_technicians.errors }}</div>{% endif %}
          </div>
        </div>

      </div>
    </div>

    <div class="d-flex gap-2">
      <button class="btn btn-primary" type="submit">Save</button>
      <a class="btn btn-outline-secondary" href="{% url 'job_tasks:list' %}">Cancel</a>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="card mb-3 shadow-sm">
      <div class="card-header bg-light fw-semibold">Links</div>
      <div class="card-body">

        <div class="mb-3">
          <div class="text-muted small mb-1">Property</div>
          {{ form.site }}
          {% if form.site.errors %}<div class="text-danger small mt-1">{{ form.site.errors }}</div>{% endif %}
        </div>

        <div class="mb-3">
          <div class="text-muted small mb-1">Customer</div>
          {{ form.customer }}
          {% if form.customer.errors %}<div class="text-danger small mt-1">{{ form.customer.errors }}</div>{% endif %}
        </div>

        <div class="mb-0">
          <div class="text-muted small mb-1">Source Routine</div>
          {{ form.service_routine }}
          {% if form.service_routine.errors %}<div class="text-danger small mt-1">{{ form.service_routine.errors }}</div>{% endif %}
        </div>

      </div>
    </div>
  </div>
</form>

{% endblock %}
